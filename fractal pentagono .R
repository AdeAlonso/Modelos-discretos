p1=c(0,0)
p2=c(8,0)
#p8=c(4,sqrt(48))
p3=c(12,sqrt(48))
p4=c(4,2*sqrt(48))
p5=c(-4,sqrt(48))
p=c(2,2)
R=100000

x=rep(0,R)
y=rep(0,R)
x[1]=p[1]
y[1]=p[2]
for(j in 2:R) {
  d=runif(1)
  if(d<1/5) {
    x[j]=0.5*(x[j-1]+p1[1])
    y[j]=0.5*(y[j-1]+p1[2])
  }
  if(d>=1/5 && d<2/5) {
    x[j]=0.5*(x[j-1]+p2[1])
    y[j]=0.5*(y[j-1]+p2[2])
  }
  if(d>=2/5 && d<3/5) {
    x[j]=0.5*(x[j-1]+p3[1])
    y[j]=0.5*(y[j-1]+p3[2])
  }
  if(d>=3/5 && d<4/5){
    x[j]=0.5*(x[j-1]+p4[1])
    y[j]=0.5*(y[j-1]+p4[2])
  }
  if(d>=4/5){
    x[j]=0.5*(x[j-1]+p5[1])
    y[j]=0.5*(y[j-1]+p5[2])
  }
}
plot(x,y,type = 'p',pch='.')